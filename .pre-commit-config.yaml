# Pre-commit config as used by ./build.py.
repos:
  # Use local to make sure the dependencies are taken from pre-commit's own environment and
  # therefore from our nix derivation.
  - repo: local
    hooks:
      - id: ruff-check
        name: Ruff linting
        entry: ruff check --fix
        language: system
        types: [python]
      - id: ruff-format
        name: Ruff formatting
        entry: ruff format
        language: system
        types: [python]
      - id: biome
        name: Biome formatting
        entry: biome format --write --files-ignore-unknown=true --no-errors-on-unmatched
        language: system
        types: [json]
      - id: rustfmt
        name: rustfmt
        entry: cargo fmt --
        language: system
        types: [rust]
        pass_filenames: false
      - id: nixfmt
        name: nixfmt
        entry: nixfmt --strict
        language: system
        types: [nix]
        exclude: extra
      - id: clippy
        name: Cargo clippy
        entry: cargo clippy --no-deps --fix --allow-dirty --allow-staged -- -Dwarnings
        language: system
        pass_filenames: false
      - id: end-of-file-fixer
        name: Ensure each file ends with a single newline
        entry: end-of-file-fixer
        language: system
        types: [text]
      - id: trailing-whitespace-fixer
        name: Trim trailing whitespace
        entry: trailing-whitespace-fixer
        language: system
        types: [text]
